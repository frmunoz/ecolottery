<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Posterior predictive checks using coalescent-based simulation of ecological communities — prdch4coalesc • ecolottery</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Posterior predictive checks using coalescent-based simulation of ecological communities — prdch4coalesc" />
<meta property="og:description" content="This function performs posterior predicitve checks assessing a model's prediction performance of either user defined summary statistics, functional diversity (intrspecific trait distributions, moments of the trait distribution, Enquist et al., 2015) or species rank-abundance plots" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">ecolottery</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.2.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/Barro_Colorado.html">`coalesc_abc` function with a site-species matrix: example with Barro-Colorado dataset.</a>
    </li>
    <li>
      <a href="../articles/coalesc_vignette.html">Appendix 1: basic functions and examples</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/frmunoz/ecolottery/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Posterior predictive checks using coalescent-based simulation of ecological communities</h1>
    
    <div class="hidden name"><code>prdch4coalesc.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function performs posterior predicitve checks assessing a model's prediction performance of either user defined summary statistics, functional diversity (intrspecific trait distributions, moments of the trait distribution, Enquist et al., 2015) or species rank-abundance plots</p>
    </div>

    <pre class="usage"><span class='fu'>prdch4coalesc</span>(<span class='no'>com.obs</span>, <span class='no'>pool</span>, <span class='no'>filt</span>, <span class='no'>params</span>, <span class='kw'>stats</span> <span class='kw'>=</span> <span class='st'>"abund"</span>, <span class='kw'>f.stats</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
              <span class='kw'>estim</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>nval</span> <span class='kw'>=</span> <span class='fl'>100</span>, <span class='kw'>progress</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>com.obs</th>
      <td><p>a data.frame of observed individuals, the first column should contain individual labels, the second the names of the species and the third species trait values - should be the same as provided for the ABC analysis in <code>coalesc_abc</code></p></td>
    </tr>
    <tr>
      <th>pool</th>
      <td><p>a data.frame containing the regional pool of species providing immigrants to the local community. It should include the label of individual on first column, its species on second column and their trait values in the third column as in <code>com.obs</code> - shuld be the same as provided for the ABC analysis in <code>coalesc-abc</code></p></td>
    </tr>
    <tr>
      <th>filt</th>
      <td><p>the inferred environmental filtering function. If <code>filt = NULL</code> predicitive checks will be performed for a purely neutral model and <code>params</code> should only be one column containing the posterior distribution of the migration rate parameter <code>m</code></p></td>
    </tr>
    <tr>
      <th>params</th>
      <td><p>the posterior distribution resulting from the ABC analysis, should be a data.frame containing each parameter distribution as columns (posterior distribution of the migration rate parameter (<code>m</code>) should be the last column)</p></td>
    </tr>
    <tr>
      <th>stats</th>
      <td><p>statistics used for the predictive checks:</p><ul>
<li><p>if <code>stats = "custom"</code>, predictive checks using a user-defined function provided in <code>f.stats</code></p></li>
<li><p>if <code>multi = "moments"</code>, predictive checks using the 4 first moments of the trait distribution evaluated by comparing the observed moments to those of 100 simulated communities under the model of interest</p></li>
<li><p>if <code>multi = "abund"</code>, returns the confidence interval for the rank-abundance curves simulated by the model as well as the observed species rank-abundance curve distinguishing between species whose relative abundance is either over or under-estimated by the model</p></li>
<li><p>if <code>multi = "intra"</code>, returns the names of species whose trait distributions are either over or under-estimated by the model by comparing the observed mean trait value per species to their simulated counterparts</p></li>
</ul></td>
    </tr>
    <tr>
      <th>f.stats</th>
      <td><p>the user-defined function computing the summary statistics to be used in the predictive checks when <code>stats = "custom"</code></p></td>
    </tr>
    <tr>
      <th>estim</th>
      <td><p>an estimator of the posterior distribution - can be either <code>"mean"</code>, <code>"median"</code> or <code>"mode"</code> used for the simulations</p></td>
    </tr>
    <tr>
      <th>nval</th>
      <td><p>the number of simulations to be run for computing predictive checks. If <code>"estim = NULL"</code> (default), a sample of size <code>nval</code> is used, if an estimator of the posterior distribution is used then <code>nval</code> replicates are used</p></td>
    </tr>
    <tr>
      <th>progress</th>
      <td><p>whether to display progress bar (default is <code>TRUE</code>)</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p></p>
<dt>pvalue</dt><dd><p>probabilities that the observed user-defined statistics are greater than
the same statistics simulated by the model (if <code>stats="custom"</code>)</p></dd> 
    
 <dt>prd.moments</dt><dd><p>probabilities that the first four moments of the observed trait distribution are greater than those simulated by the model (if <code>stats="moments"</code>)</p></dd>
    
 <dt>underestim.sp</dt><dd><p>the names of the under-represented species by the model evaluated by comparing observed relative abundances of species to those simulated by the model (if <code>stats="abund"</code>)</p></dd>
    
 <dt>overestim.sp</dt><dd><p>the names of over-represented species by the model evaluated by comparing observed relative abundances of species to those simulated by the model (if <code>stats="abund"</code>)</p></dd> 

Also, if stats="abund", rank-abundance curves are displayed distinguishing between species whose relative abundance is either over or under-estimated by the model as well as the confidence interval of the rank-abundance curves derived from the simulated communities 
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    
  
<p>Enquist, Brian J., et al. "Scaling from traits to ecosystems: developing a general trait driver theory via integrating trait-based and metabolic scaling theories." Advances in ecological research. Vol. 52. Academic Press, 2015. 249-318.</p>
<p>Csillery, Katalin, et al. "Approximate Bayesian computation (ABC) in practice." Trends in ecology &amp; evolution 25.7 (2010): 410-418.</p>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>E. Barthelemy</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='no'>pool</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span>(<span class='kw'>ind</span> <span class='kw'>=</span> <span class='fl'>1</span>:<span class='fl'>1000</span>,
                   <span class='kw'>sp</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/character.html'>as.character</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span>(<span class='fl'>1</span>:<span class='fl'>50</span>), <span class='kw'>each</span> <span class='kw'>=</span> <span class='fl'>10</span>),
                   <span class='kw'>trait</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/stats/Uniform.html'>runif</a></span>(<span class='fl'>1000</span>), <span class='kw'>stringsAsFactors</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>)
<span class='no'>com.obs</span> <span class='kw'>&lt;-</span> <span class='no'>pool</span>[<span class='fu'><a href='https://rdrr.io/r/base/sample.html'>sample</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span>(<span class='no'>pool</span>), <span class='fl'>50</span>),]

<span class='no'>f.stats</span> <span class='kw'>&lt;-</span> <span class='kw'>function</span>(<span class='no'>com</span>){
  <span class='no'>tab</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/table.html'>table</a></span>(<span class='no'>com</span>[,<span class='fl'>2</span>])
  <span class='fu'><a href='https://rdrr.io/r/base/vector.html'>as.vector</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/t.html'>t</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/lapply.html'>sapply</a></span>(<span class='fl'>0</span>:<span class='fl'>3</span>, <span class='kw'>function</span>(<span class='no'>x</span>) <span class='kw pkg'>hillR</span><span class='kw ns'>::</span><span class='fu'><a href='https://rdrr.io/pkg/hillR/man/hill_taxa.html'>hill_taxa</a></span>(<span class='no'>tab</span>, <span class='kw'>q</span><span class='kw'>=</span><span class='no'>x</span>)))) }

<span class='no'>filt</span> <span class='kw'>&lt;-</span> <span class='kw'>function</span>(<span class='no'>x</span>, <span class='no'>par</span>) <span class='fu'><a href='https://rdrr.io/r/base/Log.html'>exp</a></span>(-(<span class='no'>x</span> - <span class='no'>par</span><span class='kw'>[[</span><span class='fl'>1</span>]])^<span class='fl'>2</span>/(<span class='fl'>2</span>*<span class='no'>par</span><span class='kw'>[[</span><span class='fl'>2</span>]]^<span class='fl'>2</span>))

<span class='no'>stats</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"custom"</span>,<span class='st'>"abund"</span>, <span class='st'>"moments"</span>)

<span class='no'>params</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span>(<span class='kw'>par1</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/stats/Uniform.html'>runif</a></span>(<span class='fl'>100</span>,<span class='fl'>0</span>,<span class='fl'>1</span>),
                     <span class='kw'>par2</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/stats/Uniform.html'>runif</a></span>(<span class='fl'>100</span>, <span class='fl'>.5</span>, <span class='fl'>.9</span>),
                     <span class='kw'>par3</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/stats/Uniform.html'>runif</a></span>(<span class='fl'>100</span>,<span class='fl'>0</span>,<span class='fl'>1</span>))

<span class='no'>checks</span> <span class='kw'>&lt;-</span> <span class='fu'>prdch4coalesc</span>(<span class='no'>com.obs</span>, <span class='no'>pool</span>, <span class='no'>filt</span>, <span class='no'>params</span>, <span class='no'>stats</span>, <span class='no'>f.stats</span>)</div><div class='output co'>#&gt;   |                                                                              |                                                                      |   0%  |                                                                              |=                                                                     |   1%  |                                                                              |=                                                                     |   2%  |                                                                              |==                                                                    |   3%  |                                                                              |===                                                                   |   4%  |                                                                              |====                                                                  |   5%  |                                                                              |====                                                                  |   6%  |                                                                              |=====                                                                 |   7%  |                                                                              |======                                                                |   8%  |                                                                              |======                                                                |   9%  |                                                                              |=======                                                               |  10%  |                                                                              |========                                                              |  11%  |                                                                              |========                                                              |  12%  |                                                                              |=========                                                             |  13%  |                                                                              |==========                                                            |  14%  |                                                                              |==========                                                            |  15%  |                                                                              |===========                                                           |  16%  |                                                                              |============                                                          |  17%  |                                                                              |=============                                                         |  18%  |                                                                              |=============                                                         |  19%  |                                                                              |==============                                                        |  20%  |                                                                              |===============                                                       |  21%  |                                                                              |===============                                                       |  22%  |                                                                              |================                                                      |  23%  |                                                                              |=================                                                     |  24%  |                                                                              |==================                                                    |  25%  |                                                                              |==================                                                    |  26%  |                                                                              |===================                                                   |  27%  |                                                                              |====================                                                  |  28%  |                                                                              |====================                                                  |  29%  |                                                                              |=====================                                                 |  30%  |                                                                              |======================                                                |  31%  |                                                                              |======================                                                |  32%  |                                                                              |=======================                                               |  33%  |                                                                              |========================                                              |  34%  |                                                                              |========================                                              |  35%  |                                                                              |=========================                                             |  36%  |                                                                              |==========================                                            |  37%  |                                                                              |===========================                                           |  38%  |                                                                              |===========================                                           |  39%  |                                                                              |============================                                          |  40%  |                                                                              |=============================                                         |  41%  |                                                                              |=============================                                         |  42%  |                                                                              |==============================                                        |  43%  |                                                                              |===============================                                       |  44%  |                                                                              |================================                                      |  45%  |                                                                              |================================                                      |  46%  |                                                                              |=================================                                     |  47%  |                                                                              |==================================                                    |  48%  |                                                                              |==================================                                    |  49%  |                                                                              |===================================                                   |  50%  |                                                                              |====================================                                  |  51%  |                                                                              |====================================                                  |  52%  |                                                                              |=====================================                                 |  53%  |                                                                              |======================================                                |  54%  |                                                                              |======================================                                |  55%  |                                                                              |=======================================                               |  56%  |                                                                              |========================================                              |  57%  |                                                                              |=========================================                             |  58%  |                                                                              |=========================================                             |  59%  |                                                                              |==========================================                            |  60%  |                                                                              |===========================================                           |  61%  |                                                                              |===========================================                           |  62%  |                                                                              |============================================                          |  63%  |                                                                              |=============================================                         |  64%  |                                                                              |==============================================                        |  65%  |                                                                              |==============================================                        |  66%  |                                                                              |===============================================                       |  67%  |                                                                              |================================================                      |  68%  |                                                                              |================================================                      |  69%  |                                                                              |=================================================                     |  70%  |                                                                              |==================================================                    |  71%  |                                                                              |==================================================                    |  72%  |                                                                              |===================================================                   |  73%  |                                                                              |====================================================                  |  74%  |                                                                              |====================================================                  |  75%  |                                                                              |=====================================================                 |  76%  |                                                                              |======================================================                |  77%  |                                                                              |=======================================================               |  78%  |                                                                              |=======================================================               |  79%  |                                                                              |========================================================              |  80%  |                                                                              |=========================================================             |  81%  |                                                                              |=========================================================             |  82%  |                                                                              |==========================================================            |  83%  |                                                                              |===========================================================           |  84%  |                                                                              |============================================================          |  85%  |                                                                              |============================================================          |  86%  |                                                                              |=============================================================         |  87%  |                                                                              |==============================================================        |  88%  |                                                                              |==============================================================        |  89%  |                                                                              |===============================================================       |  90%  |                                                                              |================================================================      |  91%  |                                                                              |================================================================      |  92%  |                                                                              |=================================================================     |  93%  |                                                                              |==================================================================    |  94%  |                                                                              |==================================================================    |  95%  |                                                                              |===================================================================   |  96%  |                                                                              |====================================================================  |  97%  |                                                                              |===================================================================== |  98%  |                                                                              |===================================================================== |  99%  |                                                                              |======================================================================| 100%</div><div class='img'><img src='prdch4coalesc-1.png' alt='' width='700' height='433' /></div><div class='img'><img src='prdch4coalesc-2.png' alt='' width='700' height='433' /></div><div class='output co'>#&gt; </div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by François Munoz, Matthias Grenié, Pierre Denelle, Elizabeth Barthelemy.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.9000.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


