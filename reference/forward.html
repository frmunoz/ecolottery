<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Simulation of neutral and niche-based community dynamics forward in time — forward • ecolottery</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Simulation of neutral and niche-based community dynamics forward in time — forward" />
<meta property="og:description" content="Simulates niche-based (habitat filtering and/or limiting similarity) and neutral
community dynamics from a given initial composition, over a given number of
generations." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">ecolottery</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.2.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/Barro_Colorado.html">`coalesc_abc` function with a site-species matrix: example with Barro-Colorado dataset.</a>
    </li>
    <li>
      <a href="../articles/coalesc_vignette.html">Appendix 1: basic functions and examples</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/frmunoz/ecolottery/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Simulation of neutral and niche-based community dynamics forward in time</h1>
    
    <div class="hidden name"><code>forward.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Simulates niche-based (habitat filtering and/or limiting similarity) and neutral
community dynamics from a given initial composition, over a given number of
generations.</p>
    </div>

    <pre class="usage"><span class='fu'>forward</span>(<span class='no'>initial</span>, <span class='kw'>m</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='kw'>theta</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>d</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='kw'>gens</span> <span class='kw'>=</span> <span class='fl'>150</span>, <span class='kw'>keep</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
        <span class='kw'>pool</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>traits</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>filt</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>filt.vect</span> <span class='kw'>=</span> <span class='no'>F</span>, <span class='kw'>limit.sim</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
        <span class='kw'>limit.intra</span> <span class='kw'>=</span> <span class='no'>F</span>, <span class='kw'>par.limit</span> <span class='kw'>=</span> <span class='fl'>0.1</span>, <span class='kw'>coeff.lim.sim</span> <span class='kw'>=</span> <span class='fl'>1</span>,
        <span class='kw'>type.filt</span> <span class='kw'>=</span> <span class='st'>"immig"</span>, <span class='kw'>type.limit</span> <span class='kw'>=</span> <span class='st'>"death"</span>, <span class='kw'>add</span> <span class='kw'>=</span> <span class='no'>F</span>, <span class='kw'>var.add</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
        <span class='kw'>prob.death</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>method.dist</span> <span class='kw'>=</span> <span class='st'>"euclidean"</span>, <span class='kw'>checks</span> <span class='kw'>=</span> <span class='no'>T</span>, <span class='kw'>plot_gens</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>)
<span class='fu'>gauss_limit</span>(<span class='no'>dist</span>, <span class='no'>par</span>)
<span class='fu'>get_number_of_gens</span>(<span class='no'>given_size</span>, <span class='no'>pool</span>, <span class='kw'>traits</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>nbrep</span> <span class='kw'>=</span> <span class='fl'>5</span>, <span class='kw'>m</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='kw'>theta</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
                   <span class='kw'>d</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='kw'>gens</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>filt</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,  <span class='kw'>limit.sim</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
                   <span class='kw'>par.limit</span> <span class='kw'>=</span> <span class='fl'>0.1</span>, <span class='kw'>coeff.lim.sim</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='kw'>type.filt</span> <span class='kw'>=</span> <span class='st'>"immig"</span>,
                   <span class='kw'>type.limit</span> <span class='kw'>=</span> <span class='st'>"death"</span>, <span class='kw'>add</span> <span class='kw'>=</span> <span class='no'>F</span>, <span class='kw'>var.add</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
                   <span class='kw'>prob.death</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>method.dist</span> <span class='kw'>=</span> <span class='st'>"euclidean"</span>,
                   <span class='kw'>plot_gens</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>)
<span class='fu'>pick</span>(<span class='no'>com</span>, <span class='kw'>d</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='kw'>m</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='kw'>theta</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>pool</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>prob.death</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
     <span class='kw'>filt</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>filt.vect</span> <span class='kw'>=</span> <span class='no'>F</span>, <span class='kw'>limit.sim</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,  <span class='kw'>limit.intra</span> <span class='kw'>=</span> <span class='no'>F</span>, <span class='kw'>par.limit</span> <span class='kw'>=</span> <span class='fl'>0.1</span>,
     <span class='kw'>coeff.lim.sim</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='kw'>type.filt</span> <span class='kw'>=</span> <span class='st'>"immig"</span>, <span class='kw'>type.limit</span> <span class='kw'>=</span> <span class='st'>"death"</span>, <span class='kw'>add</span> <span class='kw'>=</span> <span class='no'>add</span>,
     <span class='kw'>var.add</span> <span class='kw'>=</span> <span class='no'>var.add</span>, <span class='kw'>new.index</span> <span class='kw'>=</span> <span class='no'>new.index</span>, <span class='kw'>method.dist</span> <span class='kw'>=</span> <span class='st'>"euclidean"</span>)
<span class='fu'>pick.mutate</span>(<span class='no'>com</span>, <span class='kw'>d</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='kw'>mu</span> <span class='kw'>=</span> <span class='fl'>0</span>, <span class='kw'>new.index</span> <span class='kw'>=</span> <span class='fl'>0</span>)
<span class='fu'>pick.immigrate</span>(<span class='no'>com</span>, <span class='kw'>d</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='kw'>m</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='no'>pool</span>, <span class='kw'>prob.death</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
              <span class='kw'>filt</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>filt.vect</span> <span class='kw'>=</span> <span class='no'>F</span>, <span class='kw'>limit.sim</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,  <span class='kw'>limit.intra</span> <span class='kw'>=</span> <span class='no'>F</span>,
              <span class='kw'>par.limit</span> <span class='kw'>=</span> <span class='fl'>0.1</span>, <span class='kw'>coeff.lim.sim</span> <span class='kw'>=</span> <span class='fl'>1</span>,
              <span class='kw'>type.filt</span> <span class='kw'>=</span> <span class='st'>"immig"</span>, <span class='kw'>type.limit</span> <span class='kw'>=</span> <span class='st'>"death"</span>, <span class='kw'>add</span> <span class='kw'>=</span> <span class='no'>F</span>, <span class='kw'>var.add</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
              <span class='kw'>method.dist</span> <span class='kw'>=</span> <span class='st'>"euclidean"</span>)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>com, initial</th>
      <td><p>starting community. It is in principle a three (or more) column matrix or
data.frame including individual ID, species names and trait values. For strictly
neutral dynamics, it can be a vector of individual species names.</p></td>
    </tr>
    <tr>
      <th>m</th>
      <td><p>migration rate (if <code>m = 1</code> the community is a subsample of the regional pool).</p></td>
    </tr>
    <tr>
      <th>theta</th>
      <td><p>parameter of neutral dynamics in the regional pool (used only if <code>pool=NULL</code>), it is the &#8220;fundamental biodiversity number&#8221; (\(\theta\)).</p></td>
    </tr>
    <tr>
      <th>mu</th>
      <td><p>mutation rate derived from \(\theta\), such as \(\mu = \theta/(2*J_m)\), where \(J_m\) is the size of the metacommunity.</p></td>
    </tr>
    <tr>
      <th>d</th>
      <td><p>number of individuals that die in each time-step.</p></td>
    </tr>
    <tr>
      <th>gens</th>
      <td><p>number of generations to simulate.</p></td>
    </tr>
    <tr>
      <th>keep</th>
      <td><p>boolean value. If <code>FALSE</code> (default) the function output only the community
composition at the end of the simulation. If <code>TRUE</code> the function output a
list of community composition at successive time steps (see Value section).</p></td>
    </tr>
    <tr>
      <th>pool</th>
      <td><p>the regional pool of species providing immigrants to the local community. It is
in principle a three-column matrix or data frame including individual ID,
species names and trait values. If trait information is missing, a random trait
value is given to individuals, from a uniform distribution between 0 and 1.
If <code>NULL</code>, the pool is simulated as a metacommunity at speciation-drift
equilibrium, based on <code>prob</code> for speciation rate.</p></td>
    </tr>
    <tr>
      <th>traits</th>
      <td><p>a matrix or data.frame including one or several traits on columns. A unique trait value is assigned to each species in the regional pool. Species names of <code>pool</code> must be included in rownames of <code>traits</code>.
If <code>traits = NULL</code> and trait information is absent from <code>pool</code>, a random trait value is given to species of the regional pool, from a uniform distribution between 0 and 1.</p></td>
    </tr>
    <tr>
      <th>given_size</th>
      <td><p>size of the community you want to have an estimate of the number of generations
needed to reach stationarity in species richness.</p></td>
    </tr>
    <tr>
      <th>nbrep</th>
      <td><p>number of replicates from which you want to estimate the number of generations
needed to reach stationarity in species richness.</p></td>
    </tr>
    <tr>
      <th>limit.sim</th>
      <td><p>if non null, limiting similarity will be simulated, based on species trait
distances (computed with the method given by <code>method.dist</code>) and a Gaussian
overlapping function.</p></td>
    </tr>
    <tr>
      <th>limit.intra</th>
      <td><p>should limiting similarity play on individual dynamics within species? Default is <code>FALSE</code>.</p></td>
    </tr>
    <tr>
      <th>par.limit</th>
      <td><p>a vector of additional parameters to be passed to the limiting similarity function defined in <code>limit.sim</code>.
If <code>NULL</code> but the <code>limit.sim</code> requires additional parameter values,
an error message will be issues.
In the case of default Gaussian limiting similarity function, the additional 
parameter value sets the standard deviation of the Gaussian function.</p></td>
    </tr>
    <tr>
      <th>coeff.lim.sim</th>
      <td><p>adjust the intensity of limiting similarity.</p></td>
    </tr>
    <tr>
      <th>type.filt</th>
      <td><p>indicates how habitat filtering plays in community assembly. 
If <code>type.filt="death"</code>, it plays on mortality events.
If <code>type.filt="immig"</code> (default), it plays at the establishment of immigrants,
If <code>type.filt="loc.recr"</code>, it plays at the establishment of local offspring.
<code>type.filt</code> can be any combination of these three values.</p></td>
    </tr>
    <tr>
      <th>type.limit</th>
      <td><p>indicates how limiting similarity plays in community assembly. 
If <code>type.limit="death"</code> (default), it plays on mortality events.
If <code>type.limit="immig"</code>, it plays at the establishment of immigrants,
If <code>type.limit="loc.recr"</code>, it plays at the establishment of local offspring.
<code>type.limit</code> can be any combination of these three values.</p></td>
    </tr>
    <tr>
      <th>filt</th>
      <td><p>the function used to represent habitat filtering. For a given trait value
<code>t</code>, <code>filt(t)</code> represents the probability that an individual with
trait <code>t</code> enters the local community.</p></td>
    </tr>
    <tr>
      <th>filt.vect</th>
      <td><p>indicates whether the filtering function can be vectorized. It means that the function can take as input a vector of trait values and provide a vector of the corresponding weights.</p></td>
    </tr>
    <tr>
      <th>add</th>
      <td><p>indicates if additional variables must be passed to <code>filt</code>. It can be, for instance, environmental data conditioning the trait-based filtering in the community. Default is FALSE.</p></td>
    </tr>
    <tr>
      <th>var.add</th>
      <td><p>additional variables to be passed to <code>filt</code> when <code>add = T</code>.</p></td>
    </tr>
    <tr>
      <th>prob.death</th>
      <td><p>provides a baseline probability of death that is homogeneous across species. It
is used in niche-based dynamics to represent the balance of baseline and
niche-dependent mortality.</p></td>
    </tr>
    <tr>
      <th>method.dist</th>
      <td><p>provides the method to compute trait distances between individuals (syntax of
function <code><a href='https://rdrr.io/r/stats/dist.html'>dist</a></code>, can be in the list <code><a href='https://rdrr.io/r/base/c.html'>c("euclidean",
"maximum", "manhattan", 
"canberra", "binary", "minkowski")</a></code>).</p></td>
    </tr>
    <tr>
      <th>new.index</th>
      <td><p>prefix used to give a new species name when speciation occurs.</p></td>
    </tr>
    <tr>
      <th>plot_gens</th>
      <td><p>plot the number of unique individuals and species over generations.</p></td>
    </tr>
    <tr>
      <th>checks</th>
      <td><p>should initial checks that the inputs are correct be performed?</p></td>
    </tr>
    <tr>
      <th>dist</th>
      <td><p>vector of trait distances that is used for calculation of limiting similarity.</p></td>
    </tr>
    <tr>
      <th>par</th>
      <td><p>addditional parameter values to be passed to <code>limit.sim</code> function.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>The model of community assembly is a zero-sum game, so that the number of individuals 
of the community is fixed to the number of individuals in initial community.</p>
<p>Two types of niche-based processes, habitat filtering and limiting similarity
can affect (i) immigration, (ii) mortality, and (iii) recruitment of local offspring.
The user can define on each of the three components the processes play, by defining 
<code>type.filt</code> and  <code>type.limit</code>. These parameters can combine one of several
values in "immig", "death" and "loc.recr" depending on either the process plays on 
immigration, (ii) mortality, and (iii) recruitment of local offspring, respectively.
For instance, defining <code>type.filt = c("immig", "death")</code> would mean that habitat 
filtering plays on both immigration and on death events. By default, <code>type.filt = "immig"</code>
and <code>type.simil = "death"</code>, which corresponds to a classical conception of 
the hierarchical influence of habitat filtering and limiting similarity on immigration success
and local survival.</p>
<p>A environmental filtering function can be defined with <code>filt</code>. It should take two arguments, the first is a trait value of a candidate immigrant, the second is a vector including the parameter values of the filtering function. See examples below for further information on usage.
An important point is that in many cases the function might be vectorized, that is, it can provide a vector of filtering probabilities for a vector of trait values given in first argument. In this case the user should set <code>filt.vect = T</code>, which will significantly accelerate simulations.</p>
<p><code>gauss_limit()</code> is the default function used to compute limiting similarity. In this case, the relative performance of an individual decreases depending on the sum of exponential distances to other individuals in the community (McArthur and Levins 1967), i.e.,</p>
<p>Function <code>get_number_of_gen()</code> allows determining the number of generations
needed to reach stationary richness for given parameterization of
<code>forward()</code>. The target number of generation is based on assessing the
change point in species richness change over time for replicate simulated
communities with random initial composition. A conservative measure is proposed
as the maximum time to reach stationary richness over the replicate simulated
communities.</p>
<p>Functions <code>pick.immigrate()</code> and <code>pick.mutate()</code> are used to simulate
immigration and speciation events within a time step. They are embedded in
forward and are not really intended for the end user.</p>
<p>A <a href='https://ecolottery.shinyapps.io/forward/'>Shiny app</a> is available to visualize simulated trait distributions for chosen parameter values in the model.</p>
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    

<dt>com</dt><dd><p>if <code>keep = FALSE</code>, a data.frame of simulated individuals, with the label
of ancestor individual in the regional pool on first column (as in the first
column of the pool), species label on second column (as in the second column of
the pool), and species trait (as in the third column of the pool).</p></dd>
<dt>pool</dt><dd><p>a data.frame of the individuals of the regional source pool, with the label of
ancestor individual in the regional pool on first column (as in first column of
input <code>pool</code>), species label on second column (as in second column of input
<code>pool</code>), and species trait (as in third column of input <code>pool</code>).</p></dd>
<dt>sp_t</dt><dd><p>a vector of species richness at each time step.</p></dd>
<dt>com_t</dt><dd><p>if <code>keep = TRUE</code>, a list of community composition for each time step 
(a data.frame as in <code>com</code>).</p></dd>
<dt>dist.t</dt><dd><p>if <code>limit.sim = TRUE</code>, the average value of the limiting similarity
function over time.</p></dd>
<dt>new.index</dt><dd><p>for <code>pick.mutate()</code>, return the new index to be used for species name at a
next speciation event.</p></dd>
<dt>call</dt><dd><p>the call function.</p></dd>

    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>For neutral dynamics, see S. P. Hubbell 2001. "The Unified Neutral Theory of
Biodiversity". Princeton University Press.</p>
<p>For the default model of limiting similarity,
MacArthur, R., Levins, R., 1967. The limiting similarity, convergence, and divergence of coexisting species. The American Naturalist 101, 377–385.</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='kw'>if</span> (<span class='fl'>FALSE</span>) {
<span class='co'># Initial community composed of 10 species each including 10 individuals</span>
<span class='no'>initial1</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/character.html'>as.character</a></span>(<span class='fl'>1</span>:<span class='fl'>10</span>), <span class='kw'>each</span> <span class='kw'>=</span> <span class='fl'>10</span>)

<span class='co'># Simulation of speciation and drift dynamics over 1000 time steps</span>
<span class='no'>final1</span> <span class='kw'>&lt;-</span> <span class='fu'>forward</span>(<span class='kw'>initial</span> <span class='kw'>=</span> <span class='no'>initial1</span>, <span class='kw'>theta</span> <span class='kw'>=</span> <span class='fl'>50</span>, <span class='kw'>gens</span> <span class='kw'>=</span> <span class='fl'>1000</span>)
<span class='co'># The final community includes new species (by default names begins with "new")</span>
<span class='no'>final1</span>$<span class='no'>com</span>$<span class='no'>sp</span> <span class='co'># includes new species generated by speciation events</span>

<span class='co'># A regional pool including 100 species each including 10 individuals</span>
<span class='no'>pool</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span>(<span class='st'>"pool.sp"</span>,<span class='fu'><a href='https://rdrr.io/r/base/character.html'>as.character</a></span>(<span class='fl'>1</span>:<span class='fl'>100</span>), <span class='kw'>sep</span><span class='kw'>=</span><span class='st'>""</span>), <span class='kw'>each</span> <span class='kw'>=</span> <span class='fl'>10</span>)

<span class='co'># Simulation of migration and drift dynamics over 1000 time steps</span>
<span class='no'>final2</span> <span class='kw'>&lt;-</span> <span class='fu'>forward</span>(<span class='kw'>initial</span> <span class='kw'>=</span> <span class='no'>initial1</span>, <span class='kw'>m</span> <span class='kw'>=</span> <span class='fl'>0.1</span>, <span class='kw'>gens</span> <span class='kw'>=</span> <span class='fl'>1000</span>, <span class='kw'>pool</span> <span class='kw'>=</span> <span class='no'>pool</span>)
<span class='co'># The final community includes species that have immigrated from the pool</span>
<span class='no'>final2</span>$<span class='no'>com</span>$<span class='no'>sp</span> <span class='co'># includes new species that immigrated from the pool</span>

<span class='co'># Initial community composed of 10 species each including 10 individuals, </span>
<span class='co'># with trait information for niche-based dynamics</span>
<span class='no'>initial2</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span>(<span class='kw'>ind</span> <span class='kw'>=</span> <span class='fl'>1</span>:<span class='fl'>100</span>, <span class='kw'>sp</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/character.html'>as.character</a></span>(<span class='fl'>1</span>:<span class='fl'>10</span>), <span class='kw'>each</span> <span class='kw'>=</span> <span class='fl'>10</span>),
                      <span class='kw'>trait</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/stats/Uniform.html'>runif</a></span>(<span class='fl'>100</span>), <span class='kw'>stringsAsFactors</span> <span class='kw'>=</span> <span class='no'>F</span>)

<span class='co'># Simulation of stabilizing hab. filtering around t = 0.5, over 2000 time steps</span>
<span class='no'>sigm</span> <span class='kw'>&lt;-</span> <span class='fl'>0.1</span>
<span class='no'>filt_gaussian</span> <span class='kw'>&lt;-</span> <span class='kw'>function</span>(<span class='no'>t</span>,<span class='no'>x</span>) <span class='fu'><a href='https://rdrr.io/r/base/Log.html'>exp</a></span>(-(<span class='no'>x</span> - <span class='no'>t</span>)^<span class='fl'>2</span>/(<span class='fl'>2</span>*<span class='no'>sigm</span>^<span class='fl'>2</span>))
<span class='co'># Filtering only plays only on immigration (default type.filt = "immig")</span>
<span class='no'>final3</span> <span class='kw'>&lt;-</span> <span class='fu'>forward</span>(<span class='kw'>initial</span> <span class='kw'>=</span> <span class='no'>initial2</span>, <span class='kw'>m</span> <span class='kw'>=</span> <span class='fl'>0.1</span>, <span class='kw'>gens</span> <span class='kw'>=</span> <span class='fl'>2000</span>, <span class='kw'>pool</span> <span class='kw'>=</span> <span class='no'>pool</span>,
                 <span class='kw'>filt</span> <span class='kw'>=</span> <span class='kw'>function</span>(<span class='no'>x</span>) <span class='fu'>filt_gaussian</span>(<span class='fl'>0.5</span>,<span class='no'>x</span>))
<span class='fu'><a href='plot_comm.html'>plot_comm</a></span>(<span class='no'>final3</span>) <span class='co'># trait distribution in final community</span>
<span class='co'># Filtering also plays on local mortality and recruitment</span>
<span class='no'>final4</span> <span class='kw'>&lt;-</span> <span class='fu'>forward</span>(<span class='kw'>initial</span> <span class='kw'>=</span> <span class='no'>initial2</span>, <span class='kw'>m</span> <span class='kw'>=</span> <span class='fl'>0.1</span>, <span class='kw'>gens</span> <span class='kw'>=</span> <span class='fl'>2000</span>, <span class='kw'>pool</span> <span class='kw'>=</span> <span class='no'>pool</span>,
                 <span class='kw'>filt</span> <span class='kw'>=</span> <span class='kw'>function</span>(<span class='no'>x</span>) <span class='fu'>filt_gaussian</span>(<span class='fl'>0.5</span>,<span class='no'>x</span>),
                 <span class='kw'>type.filt</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"immig"</span>, <span class='st'>"death"</span>, <span class='st'>"loc.recr"</span>))
<span class='fu'><a href='plot_comm.html'>plot_comm</a></span>(<span class='no'>final4</span>) <span class='co'># Stronger convergence around 0.5 </span>

<span class='co'># Simulation of stabilizing hab. filtering with two traits</span>
<span class='no'>pool</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span>(<span class='kw'>ind</span><span class='kw'>=</span><span class='fl'>1</span>:<span class='fl'>10000</span>, <span class='kw'>sp</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span>(<span class='fl'>1</span>:<span class='fl'>500</span>, <span class='fl'>20</span>), <span class='kw'>tra1</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span>(<span class='fl'>NA</span>, <span class='fl'>10000</span>), <span class='kw'>tra2</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span>(<span class='fl'>NA</span>, <span class='fl'>10000</span>))
<span class='co'># Trait values in the pool</span>
<span class='no'>t1.sp</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/Uniform.html'>runif</a></span>(<span class='fl'>500</span>)
<span class='no'>t2.sp</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/Uniform.html'>runif</a></span>(<span class='fl'>500</span>)
<span class='no'>pool</span>[, <span class='fl'>3</span>] <span class='kw'>&lt;-</span> <span class='no'>t1.sp</span>[<span class='no'>pool</span>[,<span class='fl'>2</span>]]
<span class='no'>pool</span>[, <span class='fl'>4</span>] <span class='kw'>&lt;-</span> <span class='no'>t2.sp</span>[<span class='no'>pool</span>[,<span class='fl'>2</span>]]
<span class='no'>initial3</span> <span class='kw'>&lt;-</span> <span class='no'>pool</span>[<span class='fu'><a href='https://rdrr.io/r/base/sample.html'>sample</a></span>(<span class='fl'>1</span>:<span class='fl'>10000</span>, <span class='fl'>100</span>),]
<span class='co'># Parameters of filtering for first trait</span>
<span class='no'>topt1</span> <span class='kw'>&lt;-</span> <span class='fl'>0.25</span>
<span class='no'>sigm1</span> <span class='kw'>&lt;-</span> <span class='fl'>0.1</span>
<span class='co'># Parameters of filtering for second trait</span>
<span class='no'>topt2</span> <span class='kw'>&lt;-</span> <span class='fl'>0.75</span>
<span class='no'>sigm2</span> <span class='kw'>&lt;-</span> <span class='fl'>0.2</span>
<span class='no'>filt_gaussian</span> <span class='kw'>&lt;-</span> <span class='kw'>function</span>(<span class='no'>x</span>) <span class='fu'><a href='https://rdrr.io/r/base/Log.html'>exp</a></span>(-(<span class='no'>x</span>[<span class='fl'>1</span>] - <span class='no'>topt1</span>)^<span class='fl'>2</span>/(<span class='fl'>2</span>*<span class='no'>sigm1</span>^<span class='fl'>2</span>)) * <span class='fu'><a href='https://rdrr.io/r/base/Log.html'>exp</a></span>(-(<span class='no'>x</span>[<span class='fl'>2</span>] - <span class='no'>topt2</span>)^<span class='fl'>2</span>/(<span class='fl'>2</span>*<span class='no'>sigm2</span>^<span class='fl'>2</span>))
<span class='fu'><a href='https://rdrr.io/r/base/system.time.html'>system.time</a></span>(<span class='no'>final5</span> <span class='kw'>&lt;-</span> <span class='fu'>forward</span>(<span class='kw'>initial</span> <span class='kw'>=</span> <span class='no'>initial3</span>, <span class='kw'>m</span> <span class='kw'>=</span> <span class='fl'>0.1</span>, <span class='kw'>gens</span> <span class='kw'>=</span> <span class='fl'>2000</span>, <span class='kw'>pool</span> <span class='kw'>=</span> <span class='no'>pool</span>,
                 <span class='kw'>filt</span> <span class='kw'>=</span> <span class='no'>filt_gaussian</span>))
<span class='co'># Here the filtering function can be vectorized</span>
<span class='fu'><a href='https://rdrr.io/r/base/system.time.html'>system.time</a></span>(<span class='no'>final5</span> <span class='kw'>&lt;-</span> <span class='fu'>forward</span>(<span class='kw'>initial</span> <span class='kw'>=</span> <span class='no'>initial3</span>, <span class='kw'>m</span> <span class='kw'>=</span> <span class='fl'>0.1</span>, <span class='kw'>gens</span> <span class='kw'>=</span> <span class='fl'>2000</span>, <span class='kw'>pool</span> <span class='kw'>=</span> <span class='no'>pool</span>,
                 <span class='kw'>filt</span> <span class='kw'>=</span> <span class='no'>filt_gaussian</span>, <span class='kw'>filt.vect</span> <span class='kw'>=</span> <span class='no'>T</span>))
<span class='fu'><a href='plot_comm.html'>plot_comm</a></span>(<span class='no'>final5</span>, <span class='kw'>seltrait</span> <span class='kw'>=</span> <span class='fl'>1</span>) <span class='co'># trait distribution in final community (first trait)</span>
<span class='fu'><a href='plot_comm.html'>plot_comm</a></span>(<span class='no'>final5</span>, <span class='kw'>seltrait</span> <span class='kw'>=</span> <span class='fl'>2</span>) <span class='co'># trait distribution in final community (second trait)</span>

<span class='co'># Simulation of limiting similarity, over 2000 time steps</span>
<span class='no'>final6</span> <span class='kw'>&lt;-</span> <span class='fu'>forward</span>(<span class='kw'>initial</span> <span class='kw'>=</span> <span class='no'>initial2</span>, <span class='kw'>m</span> <span class='kw'>=</span> <span class='fl'>0.1</span>, <span class='kw'>gens</span> <span class='kw'>=</span> <span class='fl'>2000</span>, <span class='kw'>pool</span> <span class='kw'>=</span> <span class='no'>pool</span>,
                 <span class='kw'>limit.sim</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)
<span class='fu'><a href='plot_comm.html'>plot_comm</a></span>(<span class='no'>final6</span>)
<span class='co'># Check temporal changes</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.html'>plot</a></span>(<span class='no'>final6</span>$<span class='no'>sp_t</span>, <span class='kw'>xlab</span> <span class='kw'>=</span> <span class='st'>"Time step"</span>, <span class='kw'>ylab</span> <span class='kw'>=</span> <span class='st'>"Community richness"</span>)
<span class='co'># Index of limiting similarity over time</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.html'>plot</a></span>(<span class='no'>final6</span>$<span class='no'>dist.t</span>, <span class='kw'>xlab</span> <span class='kw'>=</span> <span class='st'>"Time step"</span>, <span class='kw'>ylab</span> <span class='kw'>=</span> <span class='st'>"Limiting similarity"</span>)

<span class='co'># Higher migration rate, 5000 time steps</span>
<span class='co'># Limiting similarity only plays on mortality</span>
<span class='no'>final7</span> <span class='kw'>&lt;-</span> <span class='fu'>forward</span>(<span class='kw'>initial</span> <span class='kw'>=</span> <span class='no'>initial2</span>, <span class='kw'>m</span> <span class='kw'>=</span> <span class='fl'>0.7</span>, <span class='kw'>gens</span> <span class='kw'>=</span> <span class='fl'>5000</span>, <span class='kw'>pool</span> <span class='kw'>=</span> <span class='no'>pool</span>,
                 <span class='kw'>limit.sim</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)
<span class='fu'><a href='plot_comm.html'>plot_comm</a></span>(<span class='no'>final7</span>) <span class='co'># should be closer to regional distribution</span>
<span class='co'># Limiting similarity plays on immigration, mortality and local recruitment</span>
<span class='no'>final8</span> <span class='kw'>&lt;-</span> <span class='fu'>forward</span>(<span class='kw'>initial</span> <span class='kw'>=</span> <span class='no'>initial2</span>, <span class='kw'>m</span> <span class='kw'>=</span> <span class='fl'>0.7</span>, <span class='kw'>gens</span> <span class='kw'>=</span> <span class='fl'>5000</span>, <span class='kw'>pool</span> <span class='kw'>=</span> <span class='no'>pool</span>,
                 <span class='kw'>limit.sim</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>type.limit</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"immig"</span>, <span class='st'>"death"</span>, <span class='st'>"loc.recr"</span>))
<span class='fu'><a href='plot_comm.html'>plot_comm</a></span>(<span class='no'>final8</span>)
<span class='co'># Check temporal changes</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.html'>plot</a></span>(<span class='no'>final8</span>$<span class='no'>sp_t</span>, <span class='kw'>xlab</span> <span class='kw'>=</span> <span class='st'>"Time step"</span>, <span class='kw'>ylab</span> <span class='kw'>=</span> <span class='st'>"Community richness"</span>)
<span class='fu'><a href='https://rdrr.io/r/graphics/points.html'>points</a></span>(<span class='fl'>1</span>:<span class='fl'>5000</span>, <span class='no'>final7</span>$<span class='no'>sp_t</span>, <span class='kw'>col</span><span class='kw'>=</span><span class='st'>"blue"</span>)
<span class='co'># Index of limiting similarity over time</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.html'>plot</a></span>(<span class='no'>final8</span>$<span class='no'>dist.t</span>, <span class='kw'>xlab</span> <span class='kw'>=</span> <span class='st'>"Time step"</span>, <span class='kw'>ylab</span> <span class='kw'>=</span> <span class='st'>"Limiting similarity"</span>)
<span class='fu'><a href='https://rdrr.io/r/graphics/points.html'>points</a></span>(<span class='fl'>1</span>:<span class='fl'>5000</span>, <span class='no'>final7</span>$<span class='no'>dist.t</span>, <span class='kw'>col</span><span class='kw'>=</span><span class='st'>"blue"</span>)
}</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by François Munoz, Matthias Grenié, Pierre Denelle, Elizabeth Barthelemy.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.9000.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


